<html>
  <head>
	  <title>Aùõø: Autodiff for Discontinuous Programs ‚Äì Applied to Shaders</title>
  </head>

  <body style="background-color: #e0e0e0;"> <!-- style = "padding-left: 80px">-->
    <center>
    <table width=50% border=0 style="background-color: #ffffff; outline: #000000 dotted 2px; padding-left: 20px; padding-right: 20px; box-shadow: 10px 10px 10px #ccc;">

      <tr>
        <td align="center">
          <center><br>
            <font size = +3>Aùõø: Autodiff for Discontinuous Programs <br>  ‚Äì Applied to Shaders</font>
          </center>
        </td>
      </tr>

      <tr>
        <td align = "center">
          <br>
          <a href = "../index.html">Yuting Yang</a> &nbsp; &nbsp; <a href = "http://connellybarnes.com">Connelly Barnes</a> &nbsp; &nbsp; <a href = "https://andrew.adams.pub/">Andrew Adams</a> &nbsp; &nbsp; <a href = "https://www.cs.princeton.edu/~af/">Adam Finkelstein</a>
        </td>
      </tr>

      <tr>

        <td> <br><center><b>SIGGRAPH 2022</b> </center> </td>

      </tr>

      <tr>
        <td align="center">
            <br>
            <center>
            <img width=100% src="siggraph22_teaser.png"><br><br>

             <font size=-1></font>
            </center>
        </td>
      </tr>


      <tr>
        <td align = "center">
          <br>
          <table>
            <tr>
              <td><center>
                <div style = "width:100%; text-align:justify; vertical-align:top"><b>Abstract</b><br><br>
Over the last decade, automatic differentiation (AD) has profoundly impacted graphics and vision applications ‚Äî both broadly via deep learning and specifically for inverse rendering. Traditional AD methods ignore gradients at discontinuities, instead treating functions as continuous. Rendering algorithms intrinsically rely on discontinuities, crucial at object silhouettes and in general for any branching operation. Researchers have proposed fully-automatic differentiation approaches for handling discontinuities by restricting to affine functions, or semi-automatic processes restricted either to invertible functions or to specialized applications like vector graphics. This paper describes a compiler-based approach to extend reverse mode AD so as to accept arbitrary programs involving discontinuities. Our novel gradient rules generalize differentiation to work correctly, assuming there is a single discontinuity in a local neighborhood, by approximating the pre-filtered gradient over a box kernel oriented along a 1D sampling axis. We describe when such approximation rules are first-order correct, and show that this correctness criterion applies to a relatively broad class of functions. Moreover, we show that the method is effective in practice for arbitrary programs, including features for which we cannot prove correctness. We evaluate this approach on procedural shader programs, where the task is to optimize unknown parameters in order to match a target image, and our method outperforms baselines in terms of both convergence and efficiency. Our compiler outputs gradient programs in both TensorFlow (for quick prototypes) and Halide with an optional auto-scheduler (for efficiency). The compiler also outputs GLSL that renders the target image, allowing users to modify and animate the shader, which would otherwise be cumbersome in other representations such as triangle meshes or vector art.
<br><br>
          <b>Links</b>
          <ul>
          <li><a href = "siggraph_2022.pdf">Paper</a>
<!--                        <tr><td height = 30>Slides (<a href = "camo-talk.pdf">pdf</a>, <a href = "camo-talk.key">key</a>)</td></tr> -->
          <li><a href="https://vimeo.com/703521232">Video: Short (4 min)</a>
          <li><a href="https://www.youtube.com/watch?v=lXXtKgkUN1o&ab_channel=YutingYang">Video: Long (15 min)</a>
	  <li><a href="https://www.youtube.com/watch?v=HvslNmNF4Ss&feature=youtu.be&ab_channel=YutingYang">Video: Live Coding (25 min)</a>
	  <li><a href="https://github.com/yyuting/Adelta">Github (New: PyTorch backend)</a>
	  </ul>

	  <b>Basic Introduction and Tutorial</b>
	  <p>If you are new to the concept of automatic differentation for discontinuous programs, these two Medium articles introduce the basics math and the DSL for the Adelta framework:</p>
	  <ul>
	  <li><a href="https://medium.com/@yutingyang.wh/adelta-automatic-differentiation-for-discontinuous-programs-de68b4bb8119?source=friends_link&sk=b620a5835201a1bf8d21fc2ebecc6b80">Part 1</a>: Math Basics
	  <li><a href="https://medium.com/@yutingyang.wh/adelta-automatic-differentiation-for-discontinuous-programs-part-2-scope-of-expressible-29f950f47a05?source=friends_link&sk=ce40aad5f5b2857cb66b568ae44a193c">Part 2</a>: Introduction to the DSL
	  </ul>
	  <p>The tutorial below introduces how to author shaders programs and differentiate/optimize them under the Adelta framework:</p>
	  <ul>
	  <li><a href="https://medium.com/@yutingyang.wh/adelta-tutorial-part-1-differentiating-a-simple-shader-program-3168eb00c87b?source=friends_link&sk=7cf438907a72add62af0e4cca8e9bff6">Part 1</a>: Differentiating a Simple Shader Program
	  <li><a href="https://medium.com/@yutingyang.wh/adelta-tutorial-part-2-raymarching-primitive-42e28815ff45?source=friends_link&sk=81e78eecb102a9cb76b88458533ebd79">Part 2</a>: Raymarching Primitive
	  <li><a href="https://medium.com/@yutingyang.wh/adelta-tutorial-part-3-animating-the-siggraph-logo-3cbedde5e5e6?source=friends_link&sk=00193c7652f7af4d61aba6dfa3f3c8ec">Part 3</a>: Animating the SIGGRAPH logo
	  <li><a href="https://medium.com/@yutingyang.wh/adelta-tutorial-part-4-animating-the-celtic-knot-6935a0d6e535?source=friends_link&sk=ee9e9a77aad0a9f2f10636459f8d3767">Part 4</a>: Animating the Celtic Knot
	  </ul>
	  <b>Citation</b>
          <p>
		Yuting Yang, Connelly Barnes, Andrew Adams and Adam Finkelstein.
                <br>
		"AŒ¥: Autodiff for Discontinuous Programs - Applied to Shaders."
		<br>
		<i>SIGGRAPH, to appear, August 2022</i>
		, August, 2022.
		</p>
	  <b>Bibtex</b>
	  <p></p>
	  <pre>@inproceedings{Yang:2022:Adelta,
   author = "Yuting Yang and Connelly Barnes and Andrew Adams and Adam Finkelstein",
   title = "A$\delta$: Autodiff for Discontinuous Programs - Applied to Shaders",
   booktitle = "SIGGRAPH, to appear",
   year = "2022",
   month = aug
}<pre>
		</div>
                </center>
              </td>
            </tr>
          </table>
          </center>
        </td>
      </tr>

      <tr>
        <td align="left">
        </td>
      </tr>
          <!--<tr>
            <td>
              <br>
              <br>
              <div style = "text-align:center">Try to find the hidden box in a <a id = "alink" href = "">camouflage game</a>! We'll use your input in our studies.</div>
              <script>
                var id = "C" + Math.floor(10000000*Math.random());
                document.getElementById("alink").href = "http://camo-exp.appspot.com/game?assignmentId=" + id + "&workerId=" + id;
              </script>
            </td>
          </tr>-->

        <!--
          <tr>
            <td>
              <center>
              <iframe width="600" height="450" src="http://www.youtube.com/v/fjWfa7HLdjo&vq=hd720" frameborder="0" allowfullscreen></iframe>

              </center>

              <br>

            </td>
          </tr>
          -->

          <!--<tr><br>
            <td>
              <br><br>
              <b>Press:</b>&nbsp;
              <a href = "http://www.wired.com/2014/06/mit-develops-an-algorithm-that-camouflages-eyesores/">Wired</a>,&nbsp;
              <a href = "http://www.bostonglobe.com/ideas/2014/06/28/the-future-camouflage/Xi0vwqSt9q71f7StltEmcI/story.html">Boston Globe</a>,&nbsp;
              <a href = "http://www.fastcoexist.com/3030962/new-technology-lets-objects-camouflage-themselves-in-plain-sight">Fast Company Co.Exist</a>,&nbsp;
              <a href = "http://www.citylab.com/cityfixer/2014/05/a-better-way-to-camouflage-eyesores/371644/">The Atlantic Citylab</a>,&nbsp;
              <a href = "http://newsoffice.mit.edu/2014/algorithms-produce-patterns-that-could-hide-public-eyesores-0521">MIT News</a>.&nbsp;
              <br><br>
            </td>
          </tr>-->

<!--          <tr>
            <td>

              <br><b>Bibtex</b>
              <font size = 3>
<pre>
@inproceedings{barnes2015,
  title="PatchTable: Efficient Patch Queries for Large Datasets and Applications",
  author="Connelly Barnes and Fang-Lue Zhang and Liming Lou and Xian Wu and Shi-Min Hu",
  booktitle = "ACM Transactions on Graphics (Proc. SIGGRAPH)",
  year = "2015",
  month = aug
}
</pre>-->

    </table>
    </center>
